---
title: "MVS poster"
output: html_document
date: "2025-05-16"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Anaconda projekt


```{r}
library(st514)

```

## Data
```{r}
data("T6-19")
T6.19 <- tbl 
colnames(T6.19) <- c("Snout Vent Length (cm)", "Weight (kg)", "Gender")
levels(T6.19$Gender)
levels(T6.19$Gender) <- c("Female", "Male")

T6.19

```








## Explanatory Data Analysis
#SMALL SAMPLE


```{r}
# Dimensioner
dim(T6.19)
```
```{r}
#Variabeltyper
str(T6.19)
```
```{r}
#Sammendrag
summary(T6.19)
```

```{r}
# Check if the data is normally distributed
qqnorm(T6.19$`Snout Vent Length (cm)`, 
       main = "Q-Q Plot", 
       xlab = "Theoretical Quantiles", 
       ylab = "Snout Vent Length (cm)", 
       pch = 19, 
       col = "blue")
qqline(T6.19$`Snout Vent Length (cm)`, col = "red")

```

```{r}
qqnorm(T6.19$`Weight (kg)`, 
       main = "Q-Q Plot", 
       xlab = "Theoretical Quantiles", 
       ylab = "Weight (kg)", 
       pch = 19, 
       col = "blue")
qqline(T6.19$`Weight (kg)`, col = "red")
```

#Boxplot


```{r}
boxplot(`Snout Vent Length (cm)` ~ Gender, 
        data = T6.19, 
        col = c("lightblue", "lightgreen"),
        main = "Snout Vent Length by Gender",
        ylab = "Length (cm)")

boxplot(`Weight (kg)` ~ Gender, 
        data = T6.19, 
        col = c("lightblue", "lightgreen"),
        main = "Weight by Gender",
        ylab = "Weight (kg)")

```

#Pairsplot

```{r}
pairs(T6.19[, 1:2], 
      main = "Scatterplot Matrix: Length and Weight",
      pch = 21,
      bg = c("lightpink", "lightblue")[T6.19$Gender])

```

#  separate Q-Q plots pr. køn


```{r}
library(car)

qqPlot(T6.19$`Snout Vent Length (cm)`[T6.19$Gender == "Female"], 
       main = "QQ-plot: Snout Length (Female)")

qqPlot(T6.19$`Snout Vent Length (cm)`[T6.19$Gender == "Male"], 
       main = "QQ-plot: Snout Length (Male)")

```
```{r}
# QQ-plot af Weight for Female
qqPlot(T6.19$`Weight (kg)`[T6.19$Gender == "Female"], 
       main = "QQ-plot: Weight (Female)",
       ylab = "Weight (kg)")

# QQ-plot af Weight for Male
qqPlot(T6.19$`Weight (kg)`[T6.19$Gender == "Male"], 
       main = "QQ-plot: Weight (Male)",
       ylab = "Weight (kg)")

```

```{r}
library(MASS)

# Udtræk kun numeriske variabler
X <- T6.19[, 1:2]

# Beregn Mahalanobis afstande
center <- colMeans(X)
cov_mat <- cov(X)
md <- mahalanobis(X, center, cov_mat)

# Q-Q plot af D² værdier mod chi²
qqplot(qchisq(ppoints(nrow(X)), df = 2), md,
       main = "Q-Q Plot of Mahalanobis Distances",
       xlab = "Theoretical Quantiles (Chi-squared df=2)",
       ylab = "Observed Mahalanobis Distances")
abline(0, 1, col = "red")

```
```{r}
# Kvinder
female_length <- T6.19$`Snout Vent Length (cm)`[T6.19$Gender == "Female"]
male_length   <- T6.19$`Snout Vent Length (cm)`[T6.19$Gender == "Male"]

# Tæthedskurver
plot(density(female_length), 
     main = "Density Plot: Snout Length by Gender",
     xlab = "Snout Vent Length (cm)",
     col = "red", lwd = 2, ylim = c(0, 0.025))
lines(density(male_length), col = "blue", lwd = 2)

# Normalfordelingskurver (for sammenligning)
x_vals <- seq(min(T6.19$`Snout Vent Length (cm)`), max(T6.19$`Snout Vent Length (cm)`), length = 100)
lines(x_vals, dnorm(x_vals, mean = mean(female_length), sd = sd(female_length)), 
      col = "red", lty = 2)
lines(x_vals, dnorm(x_vals, mean = mean(male_length), sd = sd(male_length)), 
      col = "blue", lty = 2)

legend("topright", legend = c("Female", "Male"), col = c("red", "blue"), lwd = 2)

```

```{r}
female_weight <- T6.19$`Weight (kg)`[T6.19$Gender == "Female"]
male_weight   <- T6.19$`Weight (kg)`[T6.19$Gender == "Male"]

# Tæthedskurver
plot(density(female_weight), 
     main = "Density Plot: Weight by Gender",
     xlab = "Weight (kg)",
     col = "red", lwd = 2, ylim = c(0, 0.12))
lines(density(male_weight), col = "blue", lwd = 2)

# Normalfordelingskurver (for sammenligning)
x_vals <- seq(min(T6.19$`Weight (kg)`), max(T6.19$`Weight (kg)`), length = 100)
lines(x_vals, dnorm(x_vals, mean = mean(female_weight), sd = sd(female_weight)), 
      col = "red", lty = 2)
lines(x_vals, dnorm(x_vals, mean = mean(male_weight), sd = sd(male_weight)), 
      col = "blue", lty = 2)

legend("topright", legend = c("Female", "Male"), col = c("red", "blue"), lwd = 2)

```

